
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v3.2.2)

2026-02-05 16:56:02 [main] [] INFO  c.f.a.AnalyticsServiceApplication - Starting AnalyticsServiceApplication using Java 21.0.2 with PID 26980 (C:\Users\C15447B\Documents\personal\Food delivery application\services\analytics-service\target\analytics-service-1.0.0-SNAPSHOT.jar started by C15447B in C:\Users\C15447B\Documents\personal\Food delivery application)
2026-02-05 16:56:02 [main] [] DEBUG c.f.a.AnalyticsServiceApplication - Running with Spring Boot v3.2.2, Spring v6.1.3
2026-02-05 16:56:02 [main] [] INFO  c.f.a.AnalyticsServiceApplication - The following 1 profile is active: "local"
2026-02-05 16:56:07 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2026-02-05 16:56:07 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-02-05 16:56:08 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 462 ms. Found 2 JPA repository interfaces.
2026-02-05 16:56:09 [main] [] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=264536b3-0d77-3f57-a89f-ff061f462f9b
2026-02-05 16:56:10 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerAutoConfiguration$RetryInterceptorAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerAutoConfiguration$RetryInterceptorAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). The currently created BeanPostProcessor [lbRestClientPostProcessor] is declared through a non-static factory method on that class; consider declaring it as static instead.
2026-02-05 16:56:10 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.loadbalancer.config.BlockingLoadBalancerClientAutoConfiguration' of type [org.springframework.cloud.loadbalancer.config.BlockingLoadBalancerClientAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:10 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.loadbalancer.config.LoadBalancerAutoConfiguration' of type [org.springframework.cloud.loadbalancer.config.LoadBalancerAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:10 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda/0x0000028ec6528000] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.cloud.loadbalancer-org.springframework.cloud.client.loadbalancer.LoadBalancerClientsProperties' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerClientsProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'default.org.springframework.cloud.loadbalancer.config.LoadBalancerAutoConfiguration.LoadBalancerClientSpecification' of type [org.springframework.cloud.loadbalancer.annotation.LoadBalancerClientSpecification] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'default.org.springframework.cloud.loadbalancer.config.BlockingLoadBalancerClientAutoConfiguration.LoadBalancerClientSpecification' of type [org.springframework.cloud.loadbalancer.annotation.LoadBalancerClientSpecification] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerClientFactory' of type [org.springframework.cloud.loadbalancer.support.LoadBalancerClientFactory] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'blockingLoadBalancerClient' of type [org.springframework.cloud.loadbalancer.blocking.client.BlockingLoadBalancerClient] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerServiceInstanceCookieTransformer' of type [org.springframework.cloud.loadbalancer.core.LoadBalancerServiceInstanceCookieTransformer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'xForwarderHeadersTransformer' of type [org.springframework.cloud.loadbalancer.blocking.XForwardedHeadersTransformer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerRequestFactory' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerRequestFactory] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.loadbalancer.config.BlockingLoadBalancerClientAutoConfiguration$BlockingLoadBalancerRetryConfig' of type [org.springframework.cloud.loadbalancer.config.BlockingLoadBalancerClientAutoConfiguration$BlockingLoadBalancerRetryConfig$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancedRetryFactory' of type [org.springframework.cloud.loadbalancer.blocking.retry.BlockingLoadBalancedRetryFactory] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:11 [main] [] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerInterceptor' of type [org.springframework.cloud.client.loadbalancer.RetryLoadBalancerInterceptor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [lbRestClientPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2026-02-05 16:56:12 [main] [] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8086 (http)
2026-02-05 16:56:12 [main] [] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2026-02-05 16:56:12 [main] [] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
2026-02-05 16:56:12 [main] [] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2026-02-05 16:56:12 [main] [] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 10331 ms
2026-02-05 16:56:15 [main] [] INFO  com.zaxxer.hikari.HikariDataSource - AnalyticsHikariPool - Starting...
2026-02-05 16:56:15 [main] [] INFO  com.zaxxer.hikari.pool.HikariPool - AnalyticsHikariPool - Added connection conn0: url=jdbc:h2:mem:food_express_analytics user=SA
2026-02-05 16:56:15 [main] [] INFO  com.zaxxer.hikari.HikariDataSource - AnalyticsHikariPool - Start completed.
2026-02-05 16:56:15 [main] [] INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:food_express_analytics'
2026-02-05 16:56:18 [main] [] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2026-02-05 16:56:18 [main] [] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
2026-02-05 16:56:19 [main] [] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2026-02-05 16:56:19 [main] [] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2026-02-05 16:56:19 [main] [] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-02-05 16:56:21 [main] [] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-02-05 16:56:21 [main] [] DEBUG org.hibernate.SQL - 
    drop table if exists daily_order_metrics cascade 
Hibernate: 
    drop table if exists daily_order_metrics cascade 
2026-02-05 16:56:21 [main] [] DEBUG org.hibernate.SQL - 
    drop table if exists order_events cascade 
Hibernate: 
    drop table if exists order_events cascade 
2026-02-05 16:56:21 [main] [] DEBUG org.hibernate.SQL - 
    create table daily_order_metrics (
        avg_delivery_time_mins integer,
        avg_driver_rating numeric(3,2),
        avg_order_value numeric(10,2),
        avg_preparation_time_mins integer,
        avg_restaurant_rating numeric(3,2),
        cancelled_orders integer,
        completed_orders integer,
        delivery_fees numeric(12,2),
        discounts_given numeric(12,2),
        failed_orders integer,
        gross_revenue numeric(12,2),
        metric_date date not null,
        net_revenue numeric(12,2),
        new_customers integer,
        ratings_count integer,
        refunds_issued numeric(12,2),
        repeat_customers integer,
        tips_collected numeric(12,2),
        total_orders integer,
        unique_customers integer,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        restaurant_id varchar(255),
        primary key (id)
    )
Hibernate: 
    create table daily_order_metrics (
        avg_delivery_time_mins integer,
        avg_driver_rating numeric(3,2),
        avg_order_value numeric(10,2),
        avg_preparation_time_mins integer,
        avg_restaurant_rating numeric(3,2),
        cancelled_orders integer,
        completed_orders integer,
        delivery_fees numeric(12,2),
        discounts_given numeric(12,2),
        failed_orders integer,
        gross_revenue numeric(12,2),
        metric_date date not null,
        net_revenue numeric(12,2),
        new_customers integer,
        ratings_count integer,
        refunds_issued numeric(12,2),
        repeat_customers integer,
        tips_collected numeric(12,2),
        total_orders integer,
        unique_customers integer,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        restaurant_id varchar(255),
        primary key (id)
    )
2026-02-05 16:56:21 [main] [] DEBUG org.hibernate.SQL - 
    create table order_events (
        delivery_fee numeric(38,2),
        delivery_time_mins integer,
        discount_amount numeric(38,2),
        driver_rating integer,
        order_total numeric(38,2),
        preparation_time_mins integer,
        processed boolean,
        restaurant_rating integer,
        tip_amount numeric(38,2),
        event_time timestamp(6) not null,
        processed_at timestamp(6),
        customer_id varchar(255),
        driver_id varchar(255),
        event_type varchar(255) not null,
        id varchar(255) not null,
        metadata jsonb,
        order_id varchar(255) not null,
        restaurant_id varchar(255),
        primary key (id)
    )
Hibernate: 
    create table order_events (
        delivery_fee numeric(38,2),
        delivery_time_mins integer,
        discount_amount numeric(38,2),
        driver_rating integer,
        order_total numeric(38,2),
        preparation_time_mins integer,
        processed boolean,
        restaurant_rating integer,
        tip_amount numeric(38,2),
        event_time timestamp(6) not null,
        processed_at timestamp(6),
        customer_id varchar(255),
        driver_id varchar(255),
        event_type varchar(255) not null,
        id varchar(255) not null,
        metadata jsonb,
        order_id varchar(255) not null,
        restaurant_id varchar(255),
        primary key (id)
    )
2026-02-05 16:56:21 [main] [] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-02-05 16:56:22 [main] [] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2026-02-05 16:56:29 [main] [] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 4 endpoint(s) beneath base path '/actuator'
2026-02-05 16:56:29 [main] [] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@414cf106, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@b24fff1, org.springframework.security.web.context.SecurityContextHolderFilter@7c808f75, org.springframework.security.web.header.HeaderWriterFilter@4fd5db1d, org.springframework.web.filter.CorsFilter@2f1841c5, org.springframework.security.web.authentication.logout.LogoutFilter@4392d1ad, org.springframework.security.oauth2.server.resource.web.authentication.BearerTokenAuthenticationFilter@454e8cba, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7abc1835, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6f60173c, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@57e8e8d6, org.springframework.security.web.session.SessionManagementFilter@725de69c, org.springframework.security.web.access.ExceptionTranslationFilter@14c22e8, org.springframework.security.web.access.intercept.AuthorizationFilter@42d99e91]
2026-02-05 16:56:34 [main] [] INFO  o.s.c.n.e.c.DiscoveryClientOptionalArgsConfiguration - Eureka HTTP Client uses RestTemplate.
2026-02-05 16:56:34 [main] [] WARN  o.s.c.l.c.LoadBalancerCacheAutoConfiguration$LoadBalancerCaffeineWarnLogger - Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
2026-02-05 16:56:35 [main] [] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8086 (http) with context path ''
2026-02-05 16:56:35 [main] [] INFO  c.f.a.AnalyticsServiceApplication - Started AnalyticsServiceApplication in 35.34 seconds (process running for 37.927)
2026-02-05 16:56:35 [scheduling-1] [69847e6b02e1b9c28ff5e8332e6c834f] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 16:56:35 [scheduling-1] [69847e6b02e1b9c28ff5e8332e6c834f] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 16:56:37 [AsyncReporter{org.springframework.boot.actuate.autoconfigure.tracing.zipkin.ZipkinRestTemplateSender@4fbc516f}] [] WARN  z.r.AsyncReporter$BoundedAsyncReporter - Spans were dropped due to exceptions. All subsequent errors will be logged at FINE level.
2026-02-05 16:56:37 [AsyncReporter{org.springframework.boot.actuate.autoconfigure.tracing.zipkin.ZipkinRestTemplateSender@4fbc516f}] [] WARN  z.r.AsyncReporter$BoundedAsyncReporter - Dropped 1 spans due to ResourceAccessException(I/O error on POST request for "http://localhost:9411/api/v2/spans": Connect to http://localhost:9411 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: getsockopt)
org.springframework.web.client.ResourceAccessException: I/O error on POST request for "http://localhost:9411/api/v2/spans": Connect to http://localhost:9411 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: getsockopt
	at org.springframework.web.client.RestTemplate.createResourceAccessException(RestTemplate.java:905)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:885)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:781)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:663)
	at org.springframework.boot.actuate.autoconfigure.tracing.zipkin.ZipkinRestTemplateSender$RestTemplateHttpPostCall.doExecute(ZipkinRestTemplateSender.java:68)
	at org.springframework.boot.actuate.autoconfigure.tracing.zipkin.ZipkinRestTemplateSender$RestTemplateHttpPostCall.doExecute(ZipkinRestTemplateSender.java:48)
	at zipkin2.Call$Base.execute(Call.java:391)
	at zipkin2.reporter.AsyncReporter$BoundedAsyncReporter.flush(AsyncReporter.java:299)
	at zipkin2.reporter.AsyncReporter$Flusher.run(AsyncReporter.java:378)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.apache.hc.client5.http.HttpHostConnectException: Connect to http://localhost:9411 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:682)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:592)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:751)
	at org.apache.hc.client5.http.socket.PlainConnectionSocketFactory.lambda$connectSocket$0(PlainConnectionSocketFactory.java:91)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at org.apache.hc.client5.http.socket.PlainConnectionSocketFactory.connectSocket(PlainConnectionSocketFactory.java:90)
	at org.apache.hc.client5.http.socket.ConnectionSocketFactory.connectSocket(ConnectionSocketFactory.java:123)
	at org.apache.hc.client5.http.impl.io.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:184)
	at org.apache.hc.client5.http.impl.io.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:447)
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:162)
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:172)
	at org.apache.hc.client5.http.impl.classic.ConnectExec.execute(ConnectExec.java:142)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.ProtocolExec.execute(ProtocolExec.java:192)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.HttpRequestRetryExec.execute(HttpRequestRetryExec.java:96)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.ContentCompressionExec.execute(ContentCompressionExec.java:152)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.RedirectExec.execute(RedirectExec.java:115)
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51)
	at org.apache.hc.client5.http.impl.classic.InternalHttpClient.doExecute(InternalHttpClient.java:170)
	at org.apache.hc.client5.http.impl.classic.CloseableHttpClient.execute(CloseableHttpClient.java:87)
	at org.apache.hc.client5.http.impl.classic.CloseableHttpClient.execute(CloseableHttpClient.java:55)
	at org.apache.hc.client5.http.classic.HttpClient.executeOpen(HttpClient.java:183)
	at org.springframework.http.client.HttpComponentsClientHttpRequest.executeInternal(HttpComponentsClientHttpRequest.java:95)
	at org.springframework.http.client.AbstractStreamingClientHttpRequest.executeInternal(AbstractStreamingClientHttpRequest.java:70)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:879)
	... 8 common frames omitted
2026-02-05 16:57:35 [scheduling-1] [69847ea7d56d63266eeb3418b6d38d6e] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 16:57:35 [scheduling-1] [69847ea7d56d63266eeb3418b6d38d6e] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 16:58:35 [scheduling-1] [69847ee388a8cf47b1134c6603215386] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 16:58:35 [scheduling-1] [69847ee388a8cf47b1134c6603215386] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 16:59:35 [scheduling-1] [69847f1f17a9fb4065f3fd23acf915c0] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 16:59:35 [scheduling-1] [69847f1f17a9fb4065f3fd23acf915c0] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:00:35 [scheduling-1] [69847f5b402f8d4fef1e6f79edf723ff] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:00:35 [scheduling-1] [69847f5b402f8d4fef1e6f79edf723ff] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:01:35 [scheduling-1] [69847f97e30cace31f4d95ed4125fea2] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:01:35 [scheduling-1] [69847f97e30cace31f4d95ed4125fea2] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:02:35 [scheduling-1] [69847fd382123a10a6f24883c342b4b5] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:02:35 [scheduling-1] [69847fd382123a10a6f24883c342b4b5] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:03:35 [scheduling-1] [6984800f990c42a73508ca9066855f87] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:03:35 [scheduling-1] [6984800f990c42a73508ca9066855f87] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:04:35 [scheduling-1] [6984804b6862faead48138c04e4e2e0f] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:04:35 [scheduling-1] [6984804b6862faead48138c04e4e2e0f] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:05:35 [scheduling-1] [69848087e1b4be06d0401fbb5e9d1360] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:05:35 [scheduling-1] [69848087e1b4be06d0401fbb5e9d1360] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:06:35 [scheduling-1] [698480c3d7422bc16947282299890e66] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:06:35 [scheduling-1] [698480c3d7422bc16947282299890e66] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:07:35 [scheduling-1] [698480ff1d40991ecf8ecac13fab5515] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:07:35 [scheduling-1] [698480ff1d40991ecf8ecac13fab5515] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:08:35 [scheduling-1] [6984813b80657598da89beff8e46380b] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:08:35 [scheduling-1] [6984813b80657598da89beff8e46380b] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
2026-02-05 17:09:35 [scheduling-1] [698481777f1c34ac480f078b144940a4] DEBUG c.f.a.scheduler.AnalyticsScheduler - Starting unprocessed events batch job
2026-02-05 17:09:35 [scheduling-1] [698481777f1c34ac480f078b144940a4] DEBUG org.hibernate.SQL - 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
Hibernate: 
    select
        oe1_0.id,
        oe1_0.customer_id,
        oe1_0.delivery_fee,
        oe1_0.delivery_time_mins,
        oe1_0.discount_amount,
        oe1_0.driver_id,
        oe1_0.driver_rating,
        oe1_0.event_time,
        oe1_0.event_type,
        oe1_0.metadata,
        oe1_0.order_id,
        oe1_0.order_total,
        oe1_0.preparation_time_mins,
        oe1_0.processed,
        oe1_0.processed_at,
        oe1_0.restaurant_id,
        oe1_0.restaurant_rating,
        oe1_0.tip_amount 
    from
        order_events oe1_0 
    where
        oe1_0.processed=false 
    order by
        oe1_0.event_time 
    offset
        ? rows 
    fetch
        first ? rows only
