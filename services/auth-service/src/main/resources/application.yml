server:
  port: 8081

spring:
  application:
    name: auth-service
    
  # Redis Configuration
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      
  # OAuth2 / OKTA Configuration
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${OKTA_ISSUER_URI:https://dev-foodexpress.okta.com/oauth2/default}
          jwk-set-uri: ${OKTA_JWK_URI:https://dev-foodexpress.okta.com/oauth2/default/v1/keys}
      client:
        registration:
          okta:
            client-id: ${OKTA_CLIENT_ID:your-client-id}
            client-secret: ${OKTA_CLIENT_SECRET:your-client-secret}
            scope: openid,profile,email
            authorization-grant-type: authorization_code
            redirect-uri: "{baseUrl}/login/oauth2/code/{registrationId}"
        provider:
          okta:
            authorization-uri: ${OKTA_ISSUER_URI}/v1/authorize
            token-uri: ${OKTA_ISSUER_URI}/v1/token
            user-info-uri: ${OKTA_ISSUER_URI}/v1/userinfo
            jwk-set-uri: ${OKTA_JWK_URI}

# ==========================================
# JWT CONFIGURATION
# ==========================================
jwt:
  # In production, use strong secret from environment variable
  secret: ${JWT_SECRET:your-256-bit-secret-key-for-signing-jwt-tokens-must-be-long}
  access-token-expiration-ms: 900000      # 15 minutes
  refresh-token-expiration-ms: 604800000  # 7 days
  issuer: foodexpress

# ==========================================
# EUREKA CLIENT
# ==========================================
eureka:
  instance:
    prefer-ip-address: true
    instance-id: ${spring.application.name}:${random.value}
  client:
    service-url:
      defaultZone: ${EUREKA_URI:http://admin:admin@localhost:8761/eureka}

# ==========================================
# REDISSON CONFIGURATION
# ==========================================
redisson:
  single-server-config:
    address: redis://${REDIS_HOST:localhost}:${REDIS_PORT:6379}
    connection-minimum-idle-size: 5
    connection-pool-size: 10

# ==========================================
# ACTUATOR
# ==========================================
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always
  metrics:
    tags:
      application: ${spring.application.name}

# ==========================================
# OPENAPI
# ==========================================
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    operationsSorter: method

# ==========================================
# LOGGING
# ==========================================
logging:
  level:
    root: INFO
    com.foodexpress.auth: DEBUG
    org.springframework.security: DEBUG
